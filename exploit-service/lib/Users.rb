class Users
  @@users = {}
  begin
    File.open('passwd','r') do |f|
      lines = f.readlines
      lines.each do |line|
        line.strip!
        username,hash = line.split(':')
        @@users[username] = BCrypt::Password.new(hash)
      end
    end
  rescue Errno::ENOENT
  end

  def self.create_user(username,password)
      @@users[username] = BCrypt::Password.create(password)
      File.open('passwd','w') do |f|
        @@users.each do |u,p|
          f.puts("#{u}:#{p}")
        end
      end
  end

  def self.exist?(username)
    if @@users[username]
      true
    else
      false
    end
  end

  def self.authenticate(user,attempted_password)
    if @@users[user] == attempted_password
      true
    else
      false
    end
  end
end

